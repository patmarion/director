--- QVTKRenderWindowInteractor.py.orig
+++ QVTKRenderWindowInteractor.py
@@ -409,7 +409,11 @@
 
     def __getattr__(self, attr):
         """Makes the object behave like a vtkGenericRenderWindowInteractor"""
+        # Check if _Iren exists to prevent recursion when it's None during cleanup
+        if not hasattr(self, '_Iren') or self._Iren is None:
+            raise AttributeError(self.__class__.__name__ +
+                  " has no attribute named " + attr + " (_Iren is not initialized)")
         if attr == '__vtk__':
             return lambda t=self._Iren: t
         elif hasattr(self._Iren, attr):
@@ -419,7 +423,12 @@
 
     def Finalize(self):
         '''
         Call internal cleanup method on VTK objects
         '''
-        self._RenderWindow.Finalize()
+        # Check if _RenderWindow exists before trying to finalize it
+        # This prevents recursion errors during cleanup when _RenderWindow
+        # might have already been cleaned up
+        if hasattr(self, '_RenderWindow') and self._RenderWindow is not None:
+            self._RenderWindow.Finalize()
+            # Mark as finalized to prevent double-finalization
+            self._RenderWindow = None
 
     def CreateTimer(self, obj, evt):
@@ -454,7 +463,10 @@
         self.setCursor(qt_cursor)
 
     def closeEvent(self, evt):
-        self.Finalize()
+        # Only finalize if not already finalized and if objects still exist
+        if hasattr(self, '_RenderWindow') and self._RenderWindow is not None:
+            self.Finalize()

